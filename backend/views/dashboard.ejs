
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - AcneSense</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet"
  />
  <style>
    body {
      font-family: "Poppins", sans-serif;
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .hover-scale {
      transition: transform 0.2s ease-in-out;
    }
    
    .hover-scale:hover {
      transform: scale(1.05);
    }
    
    .status-badge {
      position: relative;
      overflow: hidden;
    }
    
    .status-badge::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s;
    }
    
    .status-badge:hover::before {
      left: 100%;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen">
  <div class="container mx-auto px-4 py-8">
    <!-- Header -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-8 border border-gray-100">
      <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
        <div>
          <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">
            <span class="text-green-600">Acne</span><span class="text-gray-800">Sense</span> 
            <span class="text-lg text-gray-500 font-normal">Dashboard</span>
          </h1>
          <p class="text-gray-600 flex items-center">
            <i class="fas fa-hand-wave text-yellow-500 mr-2"></i>
            Selamat datang kembali, <span class="font-semibold text-gray-800 ml-1"><%= user.nama %></span>!
          </p>
        </div>
        <button onclick="logout()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-xl transition-all duration-200 hover-scale shadow-md">
          <i class="fas fa-sign-out-alt mr-2"></i>Logout
        </button>
      </div>
    </div>

    <!-- User Info Card -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-8 border border-gray-100">
      <div class="flex items-center mb-6">
        <div class="w-3 h-8 bg-gradient-to-b from-blue-500 to-purple-600 rounded-full mr-4"></div>
        <h2 class="text-2xl font-bold text-gray-800">Informasi Profil</h2>
      </div>
      
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- Personal Info -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold text-gray-700 border-b border-gray-200 pb-2">Data Pribadi</h3>
          <div class="space-y-3">
            <div class="flex items-center p-3 bg-blue-50 rounded-lg">
              <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center mr-3">
                <i class="fas fa-user text-white"></i>
              </div>
              <div>
                <span class="text-gray-600 text-sm">Nama Lengkap</span>
                <p class="font-semibold text-gray-800"><%= user.nama %></p>
              </div>
            </div>
            
            <div class="flex items-center p-3 bg-green-50 rounded-lg">
              <div class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center mr-3">
                <i class="fas fa-envelope text-white"></i>
              </div>
              <div>
                <span class="text-gray-600 text-sm">Email</span>
                <p class="font-semibold text-gray-800 break-all"><%= user.email %></p>
              </div>
            </div>
          </div>
        </div>

        <!-- Birth Info -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold text-gray-700 border-b border-gray-200 pb-2">Informasi Kelahiran</h3>
          <div class="space-y-3">
            <div class="flex items-center p-3 bg-purple-50 rounded-lg">
              <div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center mr-3">
                <i class="fas fa-birthday-cake text-white"></i>
              </div>
              <div>
                <span class="text-gray-600 text-sm">Tanggal Lahir</span>
                <p class="font-semibold text-gray-800">
                  <%= new Date(user.tanggal_lahir).toLocaleDateString('id-ID', { 
                    weekday: 'long',
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                  }) %>
                </p>
              </div>
            </div>
            
            <div class="flex items-center p-3 bg-orange-50 rounded-lg">
              <div class="w-10 h-10 bg-orange-500 rounded-full flex items-center justify-center mr-3">
                <i class="fas fa-calendar text-white"></i>
              </div>
              <div>
                <span class="text-gray-600 text-sm">Umur</span>
                <p class="font-semibold text-gray-800"><%= user.umur %> tahun</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Account Info -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold text-gray-700 border-b border-gray-200 pb-2">Status Akun</h3>
          <div class="space-y-3">
            <div class="flex items-center p-3 bg-indigo-50 rounded-lg">
              <div class="w-10 h-10 bg-indigo-500 rounded-full flex items-center justify-center mr-3">
                <i class="fas fa-star text-white"></i>
              </div>
              <div>
                <span class="text-gray-600 text-sm">Status Pengguna</span>
                <p class="font-semibold">
                  <span class="status-badge inline-block px-3 py-1 rounded-full text-sm <%= user.status === 'baru' ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800' %>">
                    <%= user.status === 'baru' ? 'ðŸ†• Pengguna Baru' : 'ðŸ‘‘ Pengguna Lama' %>
                  </span>
                </p>
              </div>
            </div>

            <% if (user.Jenis_kulit) { %>
            <div class="flex items-center p-3 bg-pink-50 rounded-lg">
              <div class="w-10 h-10 bg-pink-500 rounded-full flex items-center justify-center mr-3">
                <i class="fas fa-hand-paper text-white"></i>
              </div>
              <div>
                <span class="text-gray-600 text-sm">Jenis Kulit</span>
                <p class="font-semibold text-gray-800"><%= user.Jenis_kulit %></p>
              </div>
            </div>
            <% } %>

            <% if (user.skin_tone) { %>
            <div class="flex items-center p-3 bg-yellow-50 rounded-lg">
              <div class="w-10 h-10 bg-yellow-500 rounded-full flex items-center justify-center mr-3">
                <i class="fas fa-palette text-white"></i>
              </div>
              <div>
                <span class="text-gray-600 text-sm">Tone Kulit</span>
                <p class="font-semibold text-gray-800"><%= user.skin_tone %></p>
              </div>
            </div>
            <% } %>
          </div>
        </div>
      </div>
    </div>

    <!-- Session Info -->
    <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-2xl p-6 mb-8 shadow-lg">
      <div class="flex items-center">
        <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center mr-4">
          <i class="fas fa-info-circle text-2xl"></i>
        </div>
        <div>
          <h3 class="text-xl font-bold mb-1">Informasi Sesi Login</h3>
          <p class="text-blue-100">
            <i class="fas fa-clock mr-2"></i>
            Login pada: <%= new Date(loginTime).toLocaleString('id-ID', {
              weekday: 'long',
              year: 'numeric',
              month: 'long',
              day: 'numeric',
              hour: '2-digit',
              minute: '2-digit',
              second: '2-digit'
            }) %>
          </p>
        </div>
      </div>
    </div>

    <!-- Features Cards -->
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
      <!-- Deteksi Jerawat -->
      <div class="bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300 hover-scale border border-gray-100">
        <div class="text-center">
          <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg">
            <i class="fas fa-camera text-2xl text-white"></i>
          </div>
          <h3 class="text-xl font-bold text-gray-800 mb-2">Deteksi Jerawat</h3>
          <p class="text-gray-600 text-sm mb-6 leading-relaxed">Analisis kondisi kulit wajah Anda dengan teknologi AI terdepan</p>
          <button class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-6 py-3 rounded-xl transition-all duration-200 font-semibold shadow-md hover:shadow-lg">
            <i class="fas fa-play mr-2"></i>Mulai Deteksi
          </button>
        </div>
      </div>

      <!-- Riwayat Analisis -->
      <div class="bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300 hover-scale border border-gray-100">
        <div class="text-center">
          <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-teal-500 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg">
            <i class="fas fa-chart-line text-2xl text-white"></i>
          </div>
          <h3 class="text-xl font-bold text-gray-800 mb-2">Riwayat Analisis</h3>
          <p class="text-gray-600 text-sm mb-6 leading-relaxed">Lihat perkembangan dan progress kondisi kulit dari waktu ke waktu</p>
          <button class="w-full bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white px-6 py-3 rounded-xl transition-all duration-200 font-semibold shadow-md hover:shadow-lg">
            <i class="fas fa-history mr-2"></i>Lihat Riwayat
          </button>
        </div>
      </div>

      <!-- Pengaturan -->
      <div class="bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300 hover-scale border border-gray-100">
        <div class="text-center">
          <div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-red-500 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg">
            <i class="fas fa-user-cog text-2xl text-white"></i>
          </div>
          <h3 class="text-xl font-bold text-gray-800 mb-2">Pengaturan</h3>
          <p class="text-gray-600 text-sm mb-6 leading-relaxed">Kelola profil, preferensi, dan pengaturan akun Anda</p>
          <button class="w-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white px-6 py-3 rounded-xl transition-all duration-200 font-semibold shadow-md hover:shadow-lg">
            <i class="fas fa-cog mr-2"></i>Pengaturan
          </button>
        </div>
      </div>
    </div>

    <!-- Quick Stats -->
    <div class="grid md:grid-cols-4 gap-4">
      <div class="bg-white rounded-xl p-4 shadow-md border border-gray-100">
        <div class="flex items-center">
          <div class="w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center mr-3">
            <i class="fas fa-camera text-white text-sm"></i>
          </div>
          <div>
            <p class="text-2xl font-bold text-gray-800">0</p>
            <p class="text-gray-600 text-xs">Total Deteksi</p>
          </div>
        </div>
      </div>

      <div class="bg-white rounded-xl p-4 shadow-md border border-gray-100">
        <div class="flex items-center">
          <div class="w-8 h-8 bg-green-500 rounded-lg flex items-center justify-center mr-3">
            <i class="fas fa-chart-line text-white text-sm"></i>
          </div>
          <div>
            <p class="text-2xl font-bold text-gray-800">0%</p>
            <p class="text-gray-600 text-xs">Tingkat Perbaikan</p>
          </div>
        </div>
      </div>

      <div class="bg-white rounded-xl p-4 shadow-md border border-gray-100">
        <div class="flex items-center">
          <div class="w-8 h-8 bg-purple-500 rounded-lg flex items-center justify-center mr-3">
            <i class="fas fa-calendar text-white text-sm"></i>
          </div>
          <div>
            <p class="text-2xl font-bold text-gray-800">0</p>
            <p class="text-gray-600 text-xs">Hari Aktif</p>
          </div>
        </div>
      </div>

      <div class="bg-white rounded-xl p-4 shadow-md border border-gray-100">
        <div class="flex items-center">
          <div class="w-8 h-8 bg-orange-500 rounded-lg flex items-center justify-center mr-3">
            <i class="fas fa-trophy text-white text-sm"></i>
          </div>
          <div>
            <p class="text-2xl font-bold text-gray-800">0</p>
            <p class="text-gray-600 text-xs">Achievement</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Logout function dengan SweetAlert2
    function logout() {
      Swal.fire({
        title: 'Konfirmasi Logout',
        text: 'Apakah Anda yakin ingin keluar dari dashboard?',
        icon: 'question',
        showCancelButton: true,
        confirmButtonColor: '#ef4444',
        cancelButtonColor: '#6b7280',
        confirmButtonText: '<i class="fas fa-sign-out-alt mr-2"></i>Ya, Logout',
        cancelButtonText: '<i class="fas fa-times mr-2"></i>Batal',
        reverseButtons: true,
        customClass: {
          popup: 'rounded-2xl',
          confirmButton: 'rounded-xl',
          cancelButton: 'rounded-xl'
        }
      }).then((result) => {
        if (result.isConfirmed) {
          // Show loading
          Swal.fire({
            title: 'Logging out...',
            text: 'Mohon tunggu sebentar',
            allowOutsideClick: false,
            showConfirmButton: false,
            didOpen: () => {
              Swal.showLoading();
            },
            customClass: {
              popup: 'rounded-2xl'
            }
          });

          // Perform logout
          fetch('/logout', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            }
          })
          .then(response => response.json())
          .then(data => {
            if (data.success) {
              Swal.fire({
                icon: 'success',
                title: 'Logout Berhasil!',
                text: data.message,
                timer: 1500,
                showConfirmButton: false,
                customClass: {
                  popup: 'rounded-2xl'
                }
              }).then(() => {
                window.location.href = '/login';
              });
            } else {
              Swal.fire({
                icon: 'error',
                title: 'Logout Gagal!',
                text: data.message,
                customClass: {
                  popup: 'rounded-2xl'
                }
              });
            }
          })
          .catch(error => {
            console.error('Error:', error);
            Swal.fire({
              icon: 'error',
              title: 'Error!',
              text: 'Terjadi kesalahan saat logout',
              customClass: {
                popup: 'rounded-2xl'
              }
            });
          });
        }
      });
    }

    // Welcome animation
    document.addEventListener('DOMContentLoaded', function() {
      // Animate cards on load
      const cards = document.querySelectorAll('.hover-scale');
      cards.forEach((card, index) => {
        setTimeout(() => {
          card.style.opacity = '0';
          card.style.transform = 'translateY(20px)';
          card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
          
          setTimeout(() => {
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
          }, 100);
        }, index * 100);
      });

      // Show welcome notification for new users
      <% if (user.status === 'baru') { %>
      setTimeout(() => {
        Swal.fire({
          icon: 'info',
          title: 'Selamat Datang! ðŸŽ‰',
          text: 'Anda adalah pengguna baru. Jelajahi fitur-fitur AcneSense untuk mendapatkan pengalaman terbaik!',
          confirmButtonText: 'Mulai Eksplorasi',
          customClass: {
            popup: 'rounded-2xl',
            confirmButton: 'rounded-xl'
          }
        });
      }, 2000);
      <% } %>
    });
  </script>
</body>
</html>
